---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";

const { title, description, pubDate, updatedDate, heroImage, tags } =
    Astro.props;

const tagMap: Record<string, string> = {
    press: "新聞稿",
    events: "活動資訊",
    issues: "議題發言",
    clarification: "闢謠專區",
};
---

<!doctype html>
<html lang="zh-TW">
    <head>
        <BaseHead title={title} description={description} />
    </head>
    <body>
        <Header />
        <main class="container mx-auto px-4 py-8">
            <!-- 麵包屑導航 -->
            <div class="text-sm breadcrumbs mb-4">
                <ul>
                    <li><a href="/">首頁</a></li>
                    <li><a href="/news">最新消息</a></li>
                    {
                        tags && tags.length > 0 && (
                            <li>
                                <a href={`/news/${tags[0]}`}>
                                    {tagMap[tags[0]] || tags[0]}
                                </a>
                            </li>
                        )
                    }
                    <li>{title}</li>
                </ul>
            </div>

            <article class="prose lg:prose-xl max-w-none">
                <!-- 英雄圖片 -->
                {
                    heroImage && (
                        <div class="mb-8">
                            <img
                                src={heroImage}
                                alt={title}
                                class="w-full h-auto rounded-lg shadow-xl"
                            />
                        </div>
                    )
                }

                <!-- 標題和元數據 -->
                <div class="mb-8">
                    <h1 class="text-4xl font-bold mb-4">{title}</h1>

                    <!-- 標籤 -->
                    {
                        tags && tags.length > 0 && (
                            <div class="flex gap-2 mb-4">
                                {tags.map((tag: string) => (
                                    <a
                                        href={`/news/${tag}`}
                                        class="badge badge-primary badge-lg hover:badge-secondary"
                                    >
                                        {tagMap[tag] || tag}
                                    </a>
                                ))}
                            </div>
                        )
                    }

                    <!-- 日期 -->
                    <div class="text-gray-500 flex gap-4">
                        <div>
                            發布日期: <FormattedDate date={pubDate} />
                        </div>
                        {
                            updatedDate && (
                                <div>
                                    更新日期:{" "}
                                    <FormattedDate date={updatedDate} />
                                </div>
                            )
                        }
                    </div>
                </div>

                <!-- 文章內容 -->
                <div class="mb-8">
                    <slot />
                </div>

                <!-- 返回列表按鈕 -->
                <div class="mt-8 pt-8 border-t">
                    <div class="flex gap-4">
                        <a href="/news" class="btn btn-outline">
                            ← 返回所有文章
                        </a>
                        {
                            tags && tags.length > 0 && (
                                <a
                                    href={`/news/${tags[0]}`}
                                    class="btn btn-primary"
                                >
                                    ← 返回 {tagMap[tags[0]] || tags[0]}
                                </a>
                            )
                        }
                    </div>
                </div>
            </article>
        </main>
        <Footer />
    </body>
</html>
